
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>De qui parles-t-on le plus ?</title>

  <script>
      const socket = new WebSocket(`ws://${window.location.hostname}:${window.location.port}`)
      let inputVal

      function getInputValue(){
            inputVal = document.getElementById("celebrity_button").value;
            socket.send(inputVal)
      }

      socket.addEventListener("message",  async function (event){
        try {
          let data = await event.data.text()
          data = JSON.parse(data)

            if(data.user.name){
              const user_celebrity_name = document.getElementById('user-celebrity-name')
              const user_counter= document.getElementById('user-counter')
              user_celebrity_name.innerHTML = data.user.name
              user_counter.innerHTML = data.user.counter
            }

          for (const [key, value] of Object.entries(data)) {
            let personSelector = document.getElementById(key)
            personSelector.innerHTML = value
          }
                    
          

        } catch(err){

        }
      })


      socket.addEventListener("open", function(event){
        console.log('socket open')
      })
    </script>
</head>
<body>
  
    <h1>What is your favorite celebrity?</h1>
    <input type="text" placeholder="Ex: Donald Trump" id="celebrity_button"></input>
    <button type="button" onclick="getInputValue();">Voir</button>

    <div class="ranking">
      <div class="rank">
        <h2>Emmanuel Macron</h2>
        <span id="macron">0</span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Drake</h2>
        <span id="drake"0></span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Mark Zuckerberg</h2>
        <span id="zuckerberg">0</span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Leonardo DiCaprio</h2>
        <span id="dicaprio">0</span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Beyonce</h2>
        <span id="beyonce">0</span>
        <p> tweets</p>
      </div>
      <div class="rank">
        <h2 id="user-celebrity-name">A vous de jouer</h2>
        <span id="user-counter">0</span>
        <p> tweets</p>
      </div>
    </div>
  </body>
</html>