
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>De qui parles-t-on le plus ?</title>
  <style type="text/css">
      body {
        height: 100vh;
        background-color: #39A2F3;
        background-image: url('./twitter.svg');
        font-family: 'Roboto';
        color: white;
        font-style: italic;
        display: flex;
        justify-content: space-between;
        max-width: 80vw;
        margin: auto;
    }

    h1 {
      font-size: 3rem;
    }

    .left-part {
        font-weight: 800;
        width: 50%;
        margin: auto 0;
    }

    input {
        font-weight: 300;
        background-color: transparent;
        border-top: none;
        border-left: none;
        border-right: none;
        border-bottom: 2px solid white;
        border-color: white;
    }

    button {
        border: none;
        font-weight: 600;
        font-size: 1.2rem;
        background-color: transparent;
    }

    span.not(.number) {
        color: transparent;
        -webkit-text-stroke: 1px white;
    }

    .ranking {
        display: flex;
        flex-direction: column;
        width: 50%;
    }
  </style>

  <script>
      const socket = new WebSocket(`ws://${window.location.hostname}:${window.location.port}`)
      let inputVal

      function getInputValue(){
            inputVal = document.getElementById("celebrity_button").value;
            socket.send(inputVal)
      }



      socket.addEventListener("message",  async function (event){
        try {
          let data = await event.data.text()
          data = JSON.parse(data)

            if(data.user.name){
              const user_celebrity_name = document.getElementById('user-celebrity-name')
              const user_counter= document.getElementById('user-counter')
              user_celebrity_name.innerHTML = data.user.name
              user_counter.innerHTML = data.user.counter
            }

          for (const [key, value] of Object.entries(data)) {
            let personSelector = document.getElementById(key)
            personSelector.innerHTML = value
          }


        } catch(err){

        }
      })


      socket.addEventListener("open", function(event){
        console.log('socket open')
      })
    </script>
</head>
<body>

    <div class="left-part">
      <h1>How often is your favourite </br>personality mentioned on</br><span> Twitter </span> ?</h1>
      <input type="text" placeholder="Ex: Donald Trump" id="celebrity_button" placeholder="enter the name of your favorite celebrity"></input>
      <button type="button" onclick="getInputValue();">Voir</button>
    </div>
    

    <div class="ranking">
      <div class="rank">
        <h2>Emmanuel Macron</h2>
        <span class="number" id="macron">0</span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Drake</h2>
        <span id="drake"0></span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Mark Zuckerberg</h2>
        <span id="zuckerberg">0</span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Leonardo DiCaprio</h2>
        <span id="dicaprio">0</span>
        <p>tweets</p>
      </div>
      <div class="rank">
        <h2>Beyonce</h2>
        <span id="beyonce">0</span>
        <p> tweets</p>
      </div>
      <div class="rank">
        <h2 id="user-celebrity-name">A vous de jouer</h2>
        <span id="user-counter">0</span>
        <p> tweets</p>
      </div>
    </div>
  </body>
</html>